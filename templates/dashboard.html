{% extends "base.html" %}

{% block content %}
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        line-height: 1.6;
    }

    .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }

    .header {
        text-align: center;
        color: white;
        margin-bottom: 40px;
        padding: 40px 0;
    }

    .header h1 {
        font-size: 3.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
        font-size: 1.2em;
        opacity: 0.9;
    }

    .nav-tabs {
        display: flex;
        justify-content: center;
        margin-bottom: 30px;
        background: rgba(255,255,255,0.1);
        border-radius: 15px;
        padding: 10px;
        backdrop-filter: blur(10px);
    }

    .nav-tab {
        background: transparent;
        border: none;
        color: white;
        padding: 15px 30px;
        margin: 0 5px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 1.1em;
        transition: all 0.3s ease;
    }

    .nav-tab:hover, .nav-tab.active {
        background: rgba(255,255,255,0.2);
        transform: translateY(-2px);
    }

    .tab-content {
        display: none;
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        backdrop-filter: blur(10px);
        margin-bottom: 30px;
    }

    .tab-content.active {
        display: block;
        animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .section-title {
        font-size: 2.2em;
        color: #4a5568;
        margin-bottom: 30px;
        text-align: center;
        position: relative;
    }

    .section-title::after {
        content: '';
        width: 80px;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2);
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        border-radius: 2px;
    }

    .monitoring-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 30px;
        margin-bottom: 40px;
    }

    .monitoring-card {
        background: linear-gradient(145deg, #f8fafc, #e2e8f0);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .monitoring-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 35px rgba(0,0,0,0.15);
    }

    .noise-status {
        text-align: center;
        padding: 25px;
        border-radius: 12px;
        margin-bottom: 20px;
        font-weight: 600;
        font-size: 1.1em;
    }

    .noise-safe {
        background: linear-gradient(135deg, #48bb78, #38a169);
        color: white;
    }

    .noise-moderate {
        background: linear-gradient(135deg, #ed8936, #dd6b20);
        color: white;
    }

    .noise-harmful {
        background: linear-gradient(135deg, #e53e3e, #c53030);
        color: white;
    }

    .noise-warning {
        background: linear-gradient(135deg, #ecc94b, #d69e2e);
        color: white;
    }

    .health-score {
        text-align: center;
        margin: 30px 0;
    }

    .score-circle {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background: conic-gradient(from 0deg, #48bb78 0deg, #48bb78 252deg, #e2e8f0 252deg, #e2e8f0 360deg);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        position: relative;
    }

    .score-circle::before {
        content: '';
        width: 120px;
        height: 120px;
        background: white;
        border-radius: 50%;
        position: absolute;
    }

    .score-text {
        font-size: 2.5em;
        font-weight: 700;
        color: #48bb78;
        z-index: 1;
    }

    .analysis-tabs {
        display: flex;
        margin-bottom: 20px;
        background: #f7fafc;
        border-radius: 10px;
        padding: 5px;
    }

    .analysis-tab {
        flex: 1;
        background: transparent;
        border: none;
        padding: 12px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .analysis-tab.active {
        background: white;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        color: #667eea;
    }

    .chart-container {
        height: 250px;
        background: #f8fafc;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 20px 0;
    }

    .device-card {
        background: linear-gradient(145deg, #667eea, #764ba2);
        color: white;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 20px;
        position: relative;
        overflow: hidden;
    }

    .device-card::before {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 100px;
        height: 100px;
        background: rgba(255,255,255,0.1);
        border-radius: 50%;
        transform: translate(30px, -30px);
    }

    .device-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .info-item {
        background: rgba(255,255,255,0.1);
        padding: 15px;
        border-radius: 10px;
        backdrop-filter: blur(10px);
    }

    .noise-levels {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin: 20px 0;
    }

    .noise-level-item {
        background: #f8fafc;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        border-left: 4px solid #667eea;
    }

    .ai-controls {
        background: linear-gradient(145deg, #f7fafc, #edf2f7);
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
    }

    .volume-control {
        margin: 20px 0;
    }

    .volume-slider {
        width: 100%;
        height: 8px;
        border-radius: 5px;
        background: #e2e8f0;
        outline: none;
        -webkit-appearance: none;
        appearance: none;
        margin: 10px 0;
    }

    .volume-slider::-webkit-slider-thumb {
        appearance: none;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background: #667eea;
        cursor: pointer;
    }

    .recommendations {
        background: linear-gradient(145deg, #f0fff4, #c6f6d5);
        border-radius: 15px;
        padding: 25px;
        margin-top: 20px;
    }

    .recommendation-item {
        display: flex;
        align-items: flex-start;
        margin-bottom: 15px;
        padding: 15px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .recommendation-icon {
        color: #48bb78;
        margin-right: 15px;
        font-size: 1.2em;
        margin-top: 2px;
    }

    .about-content {
        font-size: 1.1em;
        line-height: 1.8;
    }

    .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin: 40px 0;
    }

    .feature-card {
        background: linear-gradient(145deg, #667eea, #764ba2);
        color: white;
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        transition: transform 0.3s ease;
    }

    .feature-card:hover {
        transform: translateY(-8px);
    }

    .feature-icon {
        font-size: 3em;
        margin-bottom: 20px;
        opacity: 0.9;
    }

    .platform-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 30px 0;
    }

    .platform-item {
        background: #f8fafc;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        border: 2px solid #e2e8f0;
        transition: all 0.3s ease;
    }

    .platform-item:hover {
        border-color: #667eea;
        transform: translateY(-3px);
    }

    .status-indicator {
        display: inline-block;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
    }

    .status-connected {
        background: #48bb78;
        animation: pulse 2s infinite;
    }

    .status-disconnected {
        background: #e53e3e;
    }

    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }

    .listening-time {
        text-align: center;
        background: linear-gradient(145deg, #fef5e7, #fed7aa);
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
    }

    .time-display {
        font-size: 2.5em;
        font-weight: 700;
        color: #c05621;
        margin-bottom: 10px;
    }

    @media (max-width: 768px) {
        .header h1 {
            font-size: 2.5em;
        }
        
        .monitoring-grid {
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .nav-tabs {
            flex-direction: column;
            gap: 10px;
        }
        
        .device-info {
            grid-template-columns: 1fr;
        }
    }
</style>

<div class="container">
    <div class="header">
        <h1><i class="fas fa-headphones"></i> NoiseGuard</h1>
        <p>Advanced AI-Powered Hearing Health Monitoring System</p>
    </div>

    <div class="nav-tabs">
        <button class="nav-tab active" onclick="showTab('monitoring')">
            <i class="fas fa-chart-line"></i> Monitoring
        </button>
        <button class="nav-tab" onclick="showTab('connected')">
            <i class="fas fa-bluetooth"></i> Stay Connected
        </button>
        <button class="nav-tab" onclick="showTab('about')">
            <i class="fas fa-info-circle"></i> About
        </button>
    </div>

    <!-- Monitoring Section -->
    <div id="monitoring" class="tab-content active">
        <h2 class="section-title">Real-Time Hearing Health Monitoring</h2>
        
        <div class="monitoring-grid">
            <div class="monitoring-card">
                <div id="noiseStatus" class="noise-status noise-safe">
                    <i class="fas fa-shield-alt"></i><br>
                    Safe noise level (54 dB)<br>
                    Normal mode maintained.
                </div>
                <div class="chart-container">
                    <i class="fas fa-chart-area" style="font-size: 3em; color: #cbd5e0;"></i>
                    <span style="margin-left: 15px; color: #718096;">Live Noise Monitoring</span>
                </div>
            </div>

            <div class="monitoring-card">
                <h3 style="text-align: center; margin-bottom: 20px; color: #4a5568;">
                    <i class="fas fa-heart"></i> Health Score
                </h3>
                <div class="health-score">
                    <div class="score-circle">
                        <div class="score-text">85</div>
                    </div>
                    <p style="color: #48bb78; font-weight: 600;">Excellent Health Status</p>
                </div>
            </div>

            <div class="monitoring-card">
                <h3 style="text-align: center; margin-bottom: 20px; color: #4a5568;">
                    <i class="fas fa-clock"></i> Exposure Analysis
                </h3>
                <div class="analysis-tabs">
                    <button class="analysis-tab active" onclick="showAnalysis('daily')">Daily</button>
                    <button class="analysis-tab" onclick="showAnalysis('weekly')">Weekly</button>
                    <button class="analysis-tab" onclick="showAnalysis('yearly')">Yearly</button>
                </div>
                <div class="chart-container">
                    <div style="text-align: center; color: #718096;">
                        <i class="fas fa-chart-bar" style="font-size: 2.5em; margin-bottom: 10px;"></i>
                        <p>Daily Exposure: 2.5 hrs</p>
                        <p>Safe Listening Time Remaining: 5.5 hrs</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="recommendations">
            <h3 style="color: #22543d; margin-bottom: 20px;">
                <i class="fas fa-lightbulb"></i> Health Recommendations
            </h3>
            <div class="recommendation-item">
                <i class="fas fa-leaf recommendation-icon"></i>
                <div>
                    <strong>Daily Tip:</strong> Take regular breaks in quiet environments to rest your hearing.
                </div>
            </div>
            <div class="recommendation-item">
                <i class="fas fa-headphones recommendation-icon"></i>
                <div>
                    <strong>Earbud Settings:</strong> Your NoiseGuard earbuds are optimally configured for current conditions.
                </div>
            </div>
            <div class="recommendation-item">
                <i class="fas fa-shield-alt recommendation-icon"></i>
                <div>
                    <strong>Protection Status:</strong> You're maintaining excellent hearing health habits.
                </div>
            </div>
        </div>
    </div>

    <!-- Stay Connected Section -->
    <div id="connected" class="tab-content">
        <h2 class="section-title">Device Connection & AI Control</h2>

        <!-- Bluetooth Connection Card -->
        <div class="device-card" id="bluetoothCard" style="margin-bottom: 30px;">
            <h3 style="margin-bottom: 20px;">
                <i class="fas fa-bluetooth-b" style="margin-right: 10px;"></i>
                Bluetooth Connection
            </h3>
            <div id="bluetoothStatus" style="text-align: center; margin-bottom: 20px;">
                <button id="connectButton" class="nav-tab" style="background: rgba(255,255,255,0.2); margin: 10px;">
                    <i class="fas fa-bluetooth"></i> Connect Device
                </button>
                <div id="connectionStatus" style="color: white; margin: 10px; display: none;">
                    <i class="fas fa-circle-notch fa-spin"></i> <span id="statusText">Connecting...</span>
                </div>
            </div>
            <div id="deviceInfo" style="display: none; color: white; padding: 15px;">
                <div class="info-item" style="margin-bottom: 15px;">
                    <i class="fas fa-microchip" style="margin-right: 8px;"></i>
                    <strong>Device Name:</strong> <span id="deviceName">Not Connected</span>
                </div>
                <div class="info-item" style="margin-bottom: 15px;">
                    <i class="fas fa-battery-three-quarters" style="margin-right: 8px;"></i>
                    <strong>Battery Level:</strong> <span id="batteryLevel">N/A</span>
                </div>
                <div class="info-item" style="margin-bottom: 15px;">
                    <i class="fas fa-volume-up" style="margin-right: 8px;"></i>
                    <strong>Input Noise Level:</strong> <span id="inputNoiseLevel">N/A</span>
                </div>
                <div class="info-item" style="margin-bottom: 15px;">
                    <i class="fas fa-volume-down" style="margin-right: 8px;"></i>
                    <strong>Output Noise Level:</strong> <span id="outputNoiseLevel">N/A</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-shield-alt" style="margin-right: 8px;"></i>
                    <strong>AI Noise Reduction:</strong> <span id="aiStatus">N/A</span>
                </div>
            </div>
            <div id="errorMessage" style="display: none; color: #ff6b6b; margin-top: 15px; padding: 10px; background: rgba(255,0,0,0.1); border-radius: 8px;">
            </div>
        </div>

        <!-- Connected Device Details -->
        <div id="connectedDevice" class="device-card" style="display: none;">
            <h3 style="margin-bottom: 20px;">
                <span id="deviceConnectionStatus" class="status-indicator status-connected"></span>
                <span id="connectedDeviceName">NoiseGuard Pro Earbuds</span>
            </h3>
            <div class="device-info">
                <div class="info-item">
                    <i class="fas fa-battery-three-quarters" style="margin-right: 8px;"></i>
                    <strong>Battery:</strong> <span id="batteryLevel">78% (L) / 82% (R)</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-bluetooth" style="margin-right: 8px;"></i>
                    <strong>Connection:</strong> <span id="bluetoothVersion">Bluetooth 5.3</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-signal" style="margin-right: 8px;"></i>
                    <strong>Signal:</strong> <span id="signalStrength">Excellent (-45 dBm)</span>
                </div>
                <div class="info-item">
                    <i class="fas fa-microchip" style="margin-right: 8px;"></i>
                    <strong>AI Status:</strong> <span id="aiStatus">Active & Learning</span>
                </div>
            </div>
            <div style="margin-top: 20px; text-align: right;">
                <button id="disconnectButton" class="nav-tab" style="background: rgba(255,0,0,0.2);">
                    <i class="fas fa-power-off"></i> Disconnect
                </button>
            </div>
        </div>

        <div class="monitoring-grid">
            <div class="monitoring-card">
                <h3 style="text-align: center; margin-bottom: 20px; color: #4a5568;">
                    <i class="fas fa-volume-up"></i> Smart Noise Control
                </h3>
                <div class="noise-levels">
                    <div class="noise-level-item">
                        <h4 style="color: #667eea;">Input Level</h4>
                        <p style="font-size: 1.8em; font-weight: 700; color: #e53e3e;">85 dB</p>
                    </div>
                    <div class="noise-level-item">
                        <h4 style="color: #667eea;">Output Level</h4>
                        <p style="font-size: 1.8em; font-weight: 700; color: #48bb78;">58 dB</p>
                    </div>
                </div>
                <div class="ai-controls">
                    <p style="text-align: center; margin-bottom: 15px; color: #4a5568;">
                        <i class="fas fa-robot"></i> <strong>AI Noise Reduction:</strong> Active
                    </p>
                    <p style="font-size: 0.9em; color: #718096; text-align: center;">
                        Automatically converting harmful noise levels (50-85+ dB) to safe listening range (50-60 dB)
                    </p>
                </div>
            </div>

            <div class="monitoring-card">
                <h3 style="text-align: center; margin-bottom: 20px; color: #4a5568;">
                    <i class="fas fa-sliders-h"></i> Listening Control
                </h3>
                <div class="volume-control">
                    <label for="volumeSlider" style="display: block; margin-bottom: 10px; color: #4a5568;">
                        <strong>Safe Volume Limit</strong>
                    </label>
                    <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="65">
                    <div style="display: flex; justify-content: space-between; color: #718096; font-size: 0.9em;">
                        <span>0%</span>
                        <span id="volumeValue">65%</span>
                        <span>100%</span>
                    </div>
                </div>
                <div class="listening-time">
                    <div class="time-display" id="listeningTime">4:32</div>
                    <p style="color: #c05621; font-weight: 600;">Today's Listening Time</p>
                    <p style="font-size: 0.9em; color: #92400e;">Recommended: Max 8 hours at current level</p>
                </div>
            </div>

            <div class="monitoring-card">
                <h3 style="text-align: center; margin-bottom: 20px; color: #4a5568;">
                    <i class="fas fa-cog"></i> AI Configuration
                </h3>
                <div class="ai-controls">
                    <div style="margin-bottom: 20px;">
                        <label style="display: flex; align-items: center; margin-bottom: 10px;">
                            <input type="checkbox" checked style="margin-right: 10px;">
                            <span>Auto Noise Cancellation</span>
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 10px;">
                            <input type="checkbox" checked style="margin-right: 10px;">
                            <span>Smart Volume Limiting</span>
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 10px;">
                            <input type="checkbox" checked style="margin-right: 10px;">
                            <span>Environmental Adaptation</span>
                        </label>
                        <label style="display: flex; align-items: center;">
                            <input type="checkbox" style="margin-right: 10px;">
                            <span>Learning Mode (Beta)</span>
                        </label>
                    </div>
                    <p style="text-align: center; font-size: 0.9em; color: #48bb78;">
                        <i class="fas fa-check-circle"></i> All systems optimal
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- About Section -->
    <div id="about" class="tab-content">
        <h2 class="section-title">About NoiseGuard</h2>
        
        <div class="about-content">
            <p style="font-size: 1.3em; text-align: center; margin-bottom: 40px; color: #4a5568; font-weight: 300;">
                NoiseGuard represents the next generation of hearing health technology, combining advanced AI algorithms with real-time environmental monitoring to protect and optimize your auditory experience.
            </p>

            <div style="background: linear-gradient(145deg, #f7fafc, #edf2f7); border-radius: 20px; padding: 40px; margin: 40px 0;">
                <h3 style="color: #2d3748; margin-bottom: 20px; text-align: center;">
                    <i class="fas fa-rocket"></i> How NoiseGuard Works
                </h3>
                <p style="margin-bottom: 20px;">
                    Our revolutionary system employs machine learning algorithms to continuously analyze your acoustic environment and automatically adjust audio output to maintain safe listening levels between 50-60 dB, regardless of external noise conditions.
                </p>
                <p style="margin-bottom: 20px;">
                    The integrated AI system processes environmental audio in real-time, identifying harmful noise patterns and implementing protective measures before they can impact your hearing health. This proactive approach ensures optimal audio quality while maintaining safety standards.
                </p>
                <p>
                    Through continuous learning and adaptation, NoiseGuard becomes more effective over time, understanding your listening preferences and environmental patterns to provide personalized hearing protection.
                </p>
            </div>

            <h3 style="color: #2d3748; margin-bottom: 30px; text-align: center;">
                <i class="fas fa-star"></i> Key Features
            </h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <i class="fas fa-brain feature-icon"></i>
                    <h4 style="margin-bottom: 15px;">AI-Powered Protection</h4>
                    <p>Advanced machine learning algorithms provide real-time hearing protection and environmental adaptation.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-chart-line feature-icon"></i>
                    <h4 style="margin-bottom: 15px;">Real-Time Monitoring</h4>
                    <p>Continuous noise level tracking with instant feedback and safety recommendations.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-mobile-alt feature-icon"></i>
                    <h4 style="margin-bottom: 15px;">Smart Integration</h4>
                    <p>Seamless connectivity with your devices through advanced Bluetooth 5.3 technology.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-user-md feature-icon"></i>
                    <h4 style="margin-bottom: 15px;">Health Analytics</h4>
                    <p>Comprehensive hearing health scoring and personalized recommendations for optimal auditory wellness.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-shield-alt feature-icon"></i>
                    <h4 style="margin-bottom: 15px;">Automatic Safety</h4>
                    <p>Intelligent volume limiting and noise cancellation that adapts to your environment.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-database feature-icon"></i>
                    <h4 style="margin-bottom: 15px;">Long-term Tracking</h4>
                    <p>Detailed daily, weekly, and yearly analysis of your hearing exposure and health trends.</p>
                </div>
            </div>

            <div style="background: linear-gradient(145deg, #667eea, #764ba2); color: white; border-radius: 20px; padding: 40px; margin: 40px 0;">
                <h3 style="margin-bottom: 30px; text-align: center;">
                    <i class="fas fa-laptop"></i> Compatible Platforms
                </h3>
                <div class="platform-grid">
                    <div class="platform-item" style="background: rgba(255,255,255,0.1); color: white; border-color: rgba(255,255,255,0.2);">
                        <i class="fab fa-android" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4>Android App</h4>
                        <p>Full-featured mobile application</p>
                    </div>
                    <div class="platform-item" style="background: rgba(255,255,255,0.1); color: white; border-color: rgba(255,255,255,0.2);">
                        <i class="fab fa-apple" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4>iOS App</h4>
                        <p>Native iPhone and iPad support</p>
                    </div>
                    <div class="platform-item" style="background: rgba(255,255,255,0.1); color: white; border-color: rgba(255,255,255,0.2);">
                        <i class="fas fa-desktop" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4>Web Dashboard</h4>
                        <p>Comprehensive online interface</p>
                    </div>
                    <div class="platform-item" style="background: rgba(255,255,255,0.1); color: white; border-color: rgba(255,255,255,0.2);">
                        <i class="fab fa-windows" style="font-size: 2em; margin-bottom: 10px;"></i>
                        <h4>Windows Desktop</h4>
                        <p>Professional monitoring suite</p>
                    </div>
                </div>
            </div>

            <div style="text-align: center; background: #f8fafc; border-radius: 15px; padding: 30px; margin: 30px 0;">
                <h3 style="color: #2d3748; margin-bottom: 20px;">
                    <i class="fas fa-question-circle"></i> How to Get Started
                </h3>
                <p style="margin-bottom: 20px;">
                    Getting started with NoiseGuard is simple. Connect your compatible earbuds, download our application, and let our AI system begin learning your listening patterns and environmental preferences.
                </p>
                <p style="font-size: 1.1em; color: #667eea; font-weight: 600;">
                    Experience the future of hearing health protection today.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Tab switching functionality
    function showTab(tabName) {
        // Hide all tab contents
        const tabContents = document.querySelectorAll('.tab-content');
        tabContents.forEach(content => content.classList.remove('active'));
        
        // Remove active class from all tabs
        const navTabs = document.querySelectorAll('.nav-tab');
        navTabs.forEach(tab => tab.classList.remove('active'));
        
        // Show selected tab content
        document.getElementById(tabName).classList.add('active');
        
        // Add active class to clicked tab
        event.currentTarget.classList.add('active');
    }

    // Bluetooth functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Check if Web Bluetooth is supported
        if (!navigator.bluetooth) {
            showError("Web Bluetooth is not supported in this browser. Please use a compatible browser like Chrome.");
            return;
        }

        const connectButton = document.getElementById('connectButton');
        const connectionStatus = document.getElementById('connectionStatus');
        const deviceInfo = document.getElementById('deviceInfo');
        const statusText = document.getElementById('statusText');
        const deviceName = document.getElementById('deviceName');
        const batteryLevel = document.getElementById('batteryLevel');
        const inputNoiseLevel = document.getElementById('inputNoiseLevel');
        const outputNoiseLevel = document.getElementById('outputNoiseLevel');
        const aiStatus = document.getElementById('aiStatus');

        let bluetoothDevice = null;
        let gattServer = null;
        let batteryService = null;
        let noiseService = null;
        let isConnected = false;

        // Custom service and characteristic UUIDs for noise monitoring
        const NOISE_SERVICE_UUID = '00000000-0000-1000-8000-00805f9b34fb'; // Example UUID
        const INPUT_NOISE_CHARACTERISTIC_UUID = '00000001-0000-1000-8000-00805f9b34fb';
        const OUTPUT_NOISE_CHARACTERISTIC_UUID = '00000002-0000-1000-8000-00805f9b34fb';
        const AI_STATUS_CHARACTERISTIC_UUID = '00000003-0000-1000-8000-00805f9b34fb';

        connectButton.addEventListener('click', async () => {
            if (isConnected) {
                await disconnectDevice();
                return;
            }

            try {
                showStatus("Requesting Bluetooth Device...");
                bluetoothDevice = await navigator.bluetooth.requestDevice({
                    filters: [
                        { services: ['battery_service'] },
                        { namePrefix: 'NoiseGuard' }
                    ],
                    optionalServices: [NOISE_SERVICE_UUID]
                });

                bluetoothDevice.addEventListener('gattserverdisconnected', onDisconnected);

                showStatus("Connecting to GATT Server...");
                gattServer = await bluetoothDevice.gatt.connect();

                // Connect and get battery service
                showStatus("Getting Battery Service...");
                batteryService = await gattServer.getPrimaryService('battery_service');
                const batteryCharacteristic = await batteryService.getCharacteristic('battery_level');

                // Set up battery level notifications
                await batteryCharacteristic.startNotifications();
                batteryCharacteristic.addEventListener('characteristicvaluechanged', handleBatteryLevel);

                // Try to get noise service if available
                try {
                    noiseService = await gattServer.getPrimaryService(NOISE_SERVICE_UUID);
                    await setupNoiseMonitoring();
                } catch (error) {
                    console.log('Noise monitoring service not available:', error);
                }

                // Update UI for connected state
                deviceName.textContent = bluetoothDevice.name || "Unknown Device";
                showDeviceInfo();
                updateConnectionButton(true);
                isConnected = true;

            } catch (error) {
                console.error(error);
                showError("Failed to connect: " + error.message);
                await disconnectDevice();
            }
        });

        async function setupNoiseMonitoring() {
            try {
                // Set up input noise monitoring
                const inputNoiseChar = await noiseService.getCharacteristic(INPUT_NOISE_CHARACTERISTIC_UUID);
                await inputNoiseChar.startNotifications();
                inputNoiseChar.addEventListener('characteristicvaluechanged', handleInputNoise);

                // Set up output noise monitoring
                const outputNoiseChar = await noiseService.getCharacteristic(OUTPUT_NOISE_CHARACTERISTIC_UUID);
                await outputNoiseChar.startNotifications();
                outputNoiseChar.addEventListener('characteristicvaluechanged', handleOutputNoise);

                // Set up AI status monitoring
                const aiStatusChar = await noiseService.getCharacteristic(AI_STATUS_CHARACTERISTIC_UUID);
                await aiStatusChar.startNotifications();
                aiStatusChar.addEventListener('characteristicvaluechanged', handleAIStatus);
            } catch (error) {
                console.log('Error setting up noise monitoring:', error);
            }
        }

        function handleBatteryLevel(event) {
            const battery = event.target.value.getUint8(0);
            batteryLevel.textContent = battery + '%';
            updateBatteryIcon(battery);
        }

        function handleInputNoise(event) {
            const noise = event.target.value.getInt16(0, true);
            inputNoiseLevel.textContent = noise + ' dB';
        }

        function handleOutputNoise(event) {
            const noise = event.target.value.getInt16(0, true);
            outputNoiseLevel.textContent = noise + ' dB';
        }

        function handleAIStatus(event) {
            const status = event.target.value.getUint8(0);
            aiStatus.textContent = status === 1 ? 'Active' : 'Inactive';
        }

        async function disconnectDevice() {
            if (gattServer && gattServer.connected) {
                await gattServer.disconnect();
            }
            resetUI();
            isConnected = false;
            updateConnectionButton(false);
        }

        function onDisconnected() {
            resetUI();
            isConnected = false;
            updateConnectionButton(false);
            showError("Device disconnected");
        }

        function resetUI() {
            deviceInfo.style.display = 'none';
            deviceName.textContent = 'Not Connected';
            batteryLevel.textContent = 'N/A';
            inputNoiseLevel.textContent = 'N/A';
            outputNoiseLevel.textContent = 'N/A';
            aiStatus.textContent = 'N/A';
        }

        function showStatus(message) {
            connectionStatus.style.display = 'block';
            statusText.textContent = message;
        }

        function showError(message) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            setTimeout(() => {
                errorMessage.style.display = 'none';
            }, 5000);
        }

        function showDeviceInfo() {
            connectionStatus.style.display = 'none';
            deviceInfo.style.display = 'block';
        }

        function updateConnectionButton(connected) {
            connectButton.innerHTML = connected ? 
                '<i class="fas fa-power-off"></i> Disconnect' : 
                '<i class="fas fa-bluetooth"></i> Connect Device';
            connectButton.style.background = connected ? 
                'rgba(255,0,0,0.2)' : 'rgba(255,255,255,0.2)';
        }

        function updateBatteryIcon(level) {
            let batteryIcon;
            if (level >= 75) batteryIcon = 'battery-full';
            else if (level >= 50) batteryIcon = 'battery-three-quarters';
            else if (level >= 25) batteryIcon = 'battery-half';
            else if (level >= 10) batteryIcon = 'battery-quarter';
            else batteryIcon = 'battery-empty';
            
            const iconElement = batteryLevel.parentElement.querySelector('.fas');
            iconElement.className = `fas fa-${batteryIcon}`;
        }
    });
        
        // Simulated device list
        const mockDevices = [
            { name: 'NoiseGuard Pro Earbuds', id: '00:11:22:33:44:55', type: 'earbuds' },
            { name: 'NoiseGuard Studio', id: '66:77:88:99:AA:BB', type: 'headphones' },
            { name: 'NoiseGuard Sport', id: 'CC:DD:EE:FF:00:11', type: 'earbuds' }
        ];

        scanButton.addEventListener('click', function() {
            // Start scanning animation
            scanButton.style.display = 'none';
            scanningSpinner.style.display = 'block';
            devicesList.style.display = 'none';

            // Simulate scanning delay
            setTimeout(() => {
                scanningSpinner.style.display = 'none';
                devicesList.style.display = 'block';
                
                // Clear previous devices
                const listContainer = devicesList.querySelector('.device-list-container');
                listContainer.innerHTML = '';

                // Add mock devices
                mockDevices.forEach(device => {
                    const deviceElement = document.createElement('div');
                    deviceElement.className = 'info-item';
                    deviceElement.style.cursor = 'pointer';
                    deviceElement.style.marginBottom = '10px';
                    deviceElement.innerHTML = `
                        <i class="fas fa-${device.type === 'earbuds' ? 'earbuds' : 'headphones'}" style="margin-right: 8px;"></i>
                        <strong>${device.name}</strong><br>
                        <small style="margin-left: 24px;">ID: ${device.id}</small>
                    `;

                    deviceElement.addEventListener('click', () => connectToDevice(device));
                    listContainer.appendChild(deviceElement);
                });

                // Show scan button again
                scanButton.style.display = 'inline-block';
            }, 2000);
        });

        disconnectButton.addEventListener('click', function() {
            disconnectDevice();
        });

        function connectToDevice(device) {
            // Update connected device display
            document.getElementById('connectedDeviceName').textContent = device.name;
            document.getElementById('deviceConnectionStatus').className = 'status-indicator status-connected';
            
            // Show connected device card and hide device list
            devicesList.style.display = 'none';
            connectedDevice.style.display = 'block';

            // Simulate real-time monitoring
            startDeviceMonitoring();
        }

        function disconnectDevice() {
            connectedDevice.style.display = 'none';
            devicesList.style.display = 'none';
            scanButton.style.display = 'inline-block';
            stopDeviceMonitoring();
        }

        let monitoringInterval;
        function startDeviceMonitoring() {
            monitoringInterval = setInterval(() => {
                // Simulate battery level changes
                const leftBattery = Math.floor(Math.random() * 20) + 60;
                const rightBattery = Math.floor(Math.random() * 20) + 60;
                document.getElementById('batteryLevel').textContent = `${leftBattery}% (L) / ${rightBattery}% (R)`;

                // Simulate signal strength changes
                const signalStrength = Math.floor(Math.random() * 20) - 55;
                const signalQuality = signalStrength > -50 ? 'Excellent' : signalStrength > -60 ? 'Good' : 'Fair';
                document.getElementById('signalStrength').textContent = `${signalQuality} (${signalStrength} dBm)`;

                // Update AI status randomly
                const aiStates = ['Active & Learning', 'Analyzing Environment', 'Optimizing Settings', 'Calibrating'];
                const randomAiState = aiStates[Math.floor(Math.random() * aiStates.length)];
                document.getElementById('aiStatus').textContent = randomAiState;
            }, 3000);
        }

        function stopDeviceMonitoring() {
            if (monitoringInterval) {
                clearInterval(monitoringInterval);
            }
        }

    // Tab switching functionality
    function showTab(tabName) {
        // Hide all tab contents
        const tabContents = document.querySelectorAll('.tab-content');
        tabContents.forEach(content => content.classList.remove('active'));
        
        // Remove active class from all tabs
        const navTabs = document.querySelectorAll('.nav-tab');
        navTabs.forEach(tab => tab.classList.remove('active'));
        
        // Show selected tab content
        document.getElementById(tabName).classList.add('active');
        
        // Add active class to clicked tab
        event.target.classList.add('active');
    }

    // Analysis tab switching
    function showAnalysis(analysisType) {
        const analysisTabs = document.querySelectorAll('.analysis-tab');
        analysisTabs.forEach(tab => tab.classList.remove('active'));
        event.target.classList.add('active');
        
        // Update chart content based on analysis type
        updateAnalysisChart(analysisType);
    }

    function updateAnalysisChart(type) {
        const chartContainer = document.querySelector('.chart-container');
        let content = '';
        
        switch(type) {
            case 'daily':
                content = `
                    <div style="text-align: center; color: #718096;">
                        <i class="fas fa-chart-bar" style="font-size: 2.5em; margin-bottom: 10px;"></i>
                        <p>Daily Exposure: 2.5 hrs</p>
                        <p>Safe Listening Time Remaining: 5.5 hrs</p>
                    </div>
                `;
                break;
            case 'weekly':
                content = `
                    <div style="text-align: center; color: #718096;">
                        <i class="fas fa-chart-line" style="font-size: 2.5em; margin-bottom: 10px;"></i>
                        <p>Weekly Average: 3.2 hrs/day</p>
                        <p>Health Trend: Improving</p>
                    </div>
                `;
                break;
            case 'yearly':
                content = `
                    <div style="text-align: center; color: #718096;">
                        <i class="fas fa-chart-pie" style="font-size: 2.5em; margin-bottom: 10px;"></i>
                        <p>Yearly Average: 3.8 hrs/day</p>
                        <p>Health Score Trend: +15%</p>
                    </div>
                `;
                break;
        }
        
        chartContainer.innerHTML = content;
    }

    // Volume slider functionality
    const volumeSlider = document.getElementById('volumeSlider');
    const volumeValue = document.getElementById('volumeValue');
    
    volumeSlider.addEventListener('input', function() {
        volumeValue.textContent = this.value + '%';
        updateVolumeStatus(this.value);
    });

    function updateVolumeStatus(volume) {
        if (volume > 80) {
            volumeValue.style.color = '#e53e3e';
        } else if (volume > 60) {
            volumeValue.style.color = '#dd6b20';
        } else {
            volumeValue.style.color = '#48bb78';
        }
    }

    // Simulate real-time noise updates
    function simulateNoiseUpdates() {
        const noiseStatus = document.getElementById('noiseStatus');
        const scenarios = [
            {
                class: 'noise-safe',
                html: '<i class="fas fa-shield-alt"></i><br>Safe noise level (54 dB)<br>Normal mode maintained.',
                icon: 'fas fa-shield-alt'
            },
            {
                class: 'noise-moderate',
                html: '<i class="fas fa-exclamation-triangle"></i><br>Moderate noise detected (72 dB)<br>Suggestion: enable ANC in your earbud or lower exposure time.',
                icon: 'fas fa-exclamation-triangle'
            },
            {
                class: 'noise-harmful',
                html: '<i class="fas fa-exclamation-circle"></i><br>Danger! Harmful noise detected (92 dB)<br>Reduce volume or move to a quieter area immediately.',
                icon: 'fas fa-exclamation-circle'
            },
            {
                class: 'noise-warning',
                html: '<i class="fas fa-clock"></i><br>Warning: You\'ve been exposed to >85 dB for 30 minutes today<br>Consider taking a break.',
                icon: 'fas fa-clock'
            }
        ];

        let currentIndex = 0;
        setInterval(() => {
            const scenario = scenarios[currentIndex];
            noiseStatus.className = `noise-status ${scenario.class}`;
            noiseStatus.innerHTML = scenario.html;
            currentIndex = (currentIndex + 1) % scenarios.length;
        }, 8000); // Change every 8 seconds
    }

    // Update listening time
    function updateListeningTime() {
        const timeDisplay = document.getElementById('listeningTime');
        let minutes = 272; // Starting at 4:32
        
        setInterval(() => {
            minutes++;
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            timeDisplay.textContent = `${hours}:${mins.toString().padStart(2, '0')}`;
        }, 60000); // Update every minute
    }

    // Initialize dynamic features
    document.addEventListener('DOMContentLoaded', function() {
        simulateNoiseUpdates();
        updateListeningTime();
        updateVolumeStatus(65); // Initial volume status
    });

    // Health score animation
    function animateHealthScore() {
        const scoreCircle = document.querySelector('.score-circle');
        const scoreText = document.querySelector('.score-text');
        let currentScore = 0;
        const targetScore = 85;
        
        const interval = setInterval(() => {
            if (currentScore < targetScore) {
                currentScore++;
                scoreText.textContent = currentScore;
                const percentage = (currentScore / 100) * 360;
                scoreCircle.style.background = `conic-gradient(from 0deg, #48bb78 0deg, #48bb78 ${percentage}deg, #e2e8f0 ${percentage}deg, #e2e8f0 360deg)`;
            } else {
                clearInterval(interval);
            }
        }, 30);
    }

    // Start health score animation when monitoring tab is active
    setTimeout(animateHealthScore, 1000);
</script>
{% endblock %}
